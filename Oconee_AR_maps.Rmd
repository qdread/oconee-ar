---
title: "Upper Oconee AR maps"
author: "Quentin D. Read"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

Here I am going to plot some of the Upper Oconee AR data on maps, and generate some basic spatial statistics, to see if there is any spatial pattern in the data. The goal here is to do some exploratory data analysis before trying to put things into a formal statistical model.

## Processing the spatial data

The spatial data needed are:

- boundaries of the Upper Oconee watershed
- [National Land Cover Database (NLCD)](https://mrlc.gov/data) land cover type and impervious surface percentage raster data
- [National Hydrography Database (NHD)](https://www.usgs.gov/national-hydrography/access-national-hydrography-products) paths of streams and rivers in the watershed

[Main page for USGS hydrography data](https://www.usgs.gov/national-hydrography/access-national-hydrography-products)

To get the boundaries of the Upper Oconee, I looked up its [HUC8 watershed code](https://water.usgs.gov/lookup/getwatershed?03070101) which is `03070101`. I went to [this download page](https://prd-tnm.s3.amazonaws.com/index.html?prefix=StagedProducts/Hydrography/WBD/HU2/GPKG/) and downloaded [this file of the HUC2 watershed boundaries for the Southeastern USA](https://prd-tnm.s3.amazonaws.com/StagedProducts/Hydrography/WBD/HU2/GPKG/WBD_03_HU2_GPKG.zip) and pulled out the polygon for the Upper Oconee (see below).

To get the NLCD land cover type and impervious surface rasters, I downloaded the data for the entire USA (large files) from [this MRLC download page](https://www.mrlc.gov/data?f%5B0%5D=year%3A2019). The specific files I downloaded were [this one for 2019 land cover](https://s3-us-west-2.amazonaws.com/mrlc/nlcd_2019_land_cover_l48_20210604.zip) and [this one for 2019 impervious surface](https://s3-us-west-2.amazonaws.com/mrlc/nlcd_2019_impervious_l48_20210604.zip).

To get the NHD stream and river paths, I went to [this download page](https://prd-tnm.s3.amazonaws.com/index.html?prefix=StagedProducts/Hydrography/NHD/HU8/GPKG/) and downloaded [this file for the Upper Oconee HUC8 watershed](https://prd-tnm.s3.amazonaws.com/StagedProducts/Hydrography/NHD/HU8/GPKG/NHD_H_03070101_HU8_GPKG.zip).

Load the R packages.

```{r}
library(sf)
library(readxl)
library(dplyr)
library(tidyr)
library(data.table)
library(stringr)
library(zoo)
library(ggplot2)

theme_set(
  theme_bw() +
    theme(strip.background = element_blank(),
          panel.grid = element_blank())
)
```

First load the coordinates and convert to a shapefile. Save as a GeoPackage shapefile for future use. Do the same for the boundary of the Upper Oconee watershed. Also get the smaller HUC12 watershed boundaries that are contained within the single boundary of the Upper Oconee. (Note: this portion of the code is not run when the notebook is created.)

```{r, eval = FALSE}
site_locs <- read_xlsx('project/AR paper_sampling sites_location.xlsx')
names(site_locs) <- c('site', 'lat', 'lon')

site_sp <- st_as_sf(site_locs, coords = c('lon', 'lat'), crs = st_crs('+proj=longlat')) %>%
  mutate(area = substr(site, 1, 4))

st_write(site_sp, 'project/sites.gpkg', driver = 'GPKG')

st_layers('~/spatial_data/WBD_03_HU2_GPKG.gpkg')
huc8s <- st_read(dsn = '~/spatial_data/WBD_03_HU2_GPKG.gpkg', layer = 'WBDHU8')
upper_oconee <- huc8s %>% filter(huc8 == '03070101')

st_write(upper_oconee, 'project/upper_oconee.gpkg', driver = 'GPKG')

huc12s <- st_read(dsn = '~/spatial_data/WBD_03_HU2_GPKG.gpkg', layer = 'WBDHU12')
upper_oconee_huc12s <- huc12s %>% filter(substr(huc12, 1, 8) == '03070101') %>%
  st_transform(crs = st_crs(site_sp))

# Get only the huc12s intersecting with the sites.
huc12s_use <- apply(st_intersects(upper_oconee_huc12s, site_sp, sparse = FALSE), 1, any)
st_write(upper_oconee_huc12s[huc12s_use,], 'project/study_region_huc12s.gpkg', driver = 'GPKG')
```

Transform watershed boundary shapefile to the same projection as the NLCD rasters so it can be used to crop them.

```{r, eval = FALSE}
library(stars)
nlcd <- read_stars('~/spatial_data/nlcd_2019_land_cover_l48_20210604.img')
upper_oconee <- st_read('project/upper_oconee.gpkg')
upper_oconee_AEA <- st_transform(upper_oconee, crs = st_crs(nlcd))
st_write(upper_oconee_AEA, 'project/upper_oconee_AEA.gpkg', driver = 'GPKG')
```

Finally, crop the NLCD raster to those boundaries. This is done with a shell script on SciNet because I do not have my local computer configured to use GDAL in this way.

```{bash, eval = FALSE}
module load gdal
cd /project/qdr/spatial

gdalwarp -crop_to_cutline -cutline upper_oconee_AEA.gpkg -of GTiff nlcd_2019_land_cover_l48_20210604.img nlcd_land_cover_upper_oconee.tif
gdalwarp -crop_to_cutline -cutline upper_oconee_AEA.gpkg -of GTiff nlcd_2019_impervious_l48_20210604.img nlcd_impervious_upper_oconee.tif
```

## Read and process raw data

Next, read the raw data in and convert it to a form usable for analysis and mapping. We will need to:

- Fill in environmental data covariates in cases where a sample has multiple isolates.
- Distinguish rows where species is `-` from rows where there is no data.
- Create separate datasets for environmental covariates, lactamase presence-absence, antibiotic concentrations, and ARG absolute and relative copy numbers that can be joined together later.

Some code here was copied from the UGA statistician's code. While looking at the UGA statistician's code I noticed that they removed any isolate beyond the first from the dataset from each sample. So that is probably not good. I have corrected this.

```{r, eval = FALSE}
water_sample_rawdata <- read_xlsx('project/AR paper_stat analysis_tables.xlsx', sheet = 'water samples', skip = 7) |> setDT()
wastewater_sample_rawdata <- read_xlsx('project/AR paper_stat analysis_tables.xlsx', sheet = 'wastewater samples', skip = 6) |> setDT()

# Column names created by UGA statistician
correct_names_watersample = c("sample_no", 'season', 'site', 
                              'temperature','pH','conductivity','turbidity','Ecoli_counts',
                              'Bl_species',
                              'Bl_Amp','Bl_Faz','Bl_Fep','Bl_Fot','Bl_Fox','Bl_Pod','Bl_Taz','Bl_Axo','Bl_Cep','Bl_Cip','Bl_Gen','Bl_Imi','Bl_P_T4','Bl_Mer',
                              'Bl_blaCTX_M','Bl_blaTEM','Bl_blaCMY_2','Bl_blaSHV','Bl_blaOXA','Bl_blaIMI_NmcA','Bl_blaKPC',
                              'ESBL','CRE',
                              'AR_Ecoli_presence',
                              'AR_Ecoli_Amo_Cla','AR_Ecoli_Amp','AR_Ecoli_Azi','AR_Ecoli_Chl','AR_Ecoli_Fox','AR_Ecoli_Tio','AR_Ecoli_Axo','AR_Ecoli_Cip','AR_Ecoli_Gen','AR_Ecoli_Nal','AR_Ecoli_Str','AR_Ecoli_Sul','AR_Ecoli_Tet','AR_Ecoli_Tri_Smx',
                              'Salmonella_presence',
                              'Salmonella_Amo_Cla','Salmonella_Amp','Salmonella_Fox','Salmonella_Tio','Salmonella_Axo','Salmonella_Chl','Salmonella_Gen','Salmonella_Str','Salmonella_Sul','Salmonella_Tet',
                              'Enterococcus_presence',
                              'Enterococcus_Cip','Enterococcus_Dap','Enterococcus_Ery','Enterococcus_Lin','Enterococcus_Nit','Enterococcus_Pen','Enterococcus_Str','Enterococcus_Syn','Enterococcus_Tet','Enterococcus_Tyl',
                              'Amo','Amp','Azi','Axo','Taz','Tio','Cip','Dap','Ery','Gen','Kan','Lin','Lnz','Mer','Met','Nal',
                              'Oxa','Pen','Smx','Sul','Str','Tig','Tri','Tet','Tyl','Van','total',
                              'abs_ermB','abs_tetB','abs_blaKPC','abs_blaSHV','abs_qnrS','abs_blaCTX-M','abs_total',
                              'rlt_ermB','rlt_tetB','rlt_blaKPC','rlt_blaSHV','rlt_qnrS','rlt_blaCTX-M','rlt_total'
)

setnames(water_sample_rawdata, correct_names_watersample)
water_sample_rawdata[, area := substr(site, 1, 4)]
water_sample_rawdata[, season := tolower(season)]

# Create environmental dataframe with no duplicated rows
id_cols <- c(correct_names_watersample[1:3], 'area')
env_cols <- c(id_cols, correct_names_watersample[4:8])

water_sample_environmental <- water_sample_rawdata[, ..env_cols]
water_sample_environmental <- water_sample_environmental[!is.na(sample_no) & !duplicated(sample_no)]

# Separate the column with AR salmonella presence and number of isolates combined into one column into two separate columns
water_sample_rawdata[, Salmonella_n_isolates := as.numeric(str_extract(Salmonella_presence, '[0-9]'))]
water_sample_rawdata[, Salmonella_presence := substr(Salmonella_presence, 1, 1)]

# Separate antibiotic concentrations into a separate dataframe
antibiotic_conc_idx <- which(names(water_sample_rawdata) == 'Amo'):which(names(water_sample_rawdata) == 'total')
antibiotic_conc_cols <- c(id_cols, names(water_sample_rawdata)[antibiotic_conc_idx])

# Here also get rid of the duplicated rows
water_sample_antibiotic_conc <- water_sample_rawdata[, ..antibiotic_conc_cols]
water_sample_antibiotic_conc <- water_sample_antibiotic_conc[!is.na(sample_no) & !duplicated(sample_no)]

# Separate ARG copy numbers into a separate dataframe
arg_copy_cols <- c(id_cols, grep('(^abs)|(^rlt)', names(water_sample_rawdata), value = TRUE))

# Again, get rid of the duplicated rows
water_sample_arg_copynum <- water_sample_rawdata[, ..arg_copy_cols]
water_sample_arg_copynum <- water_sample_arg_copynum[!is.na(sample_no) & !duplicated(sample_no)]

# Separate beta-lactamase into a separate dataframe
bl_cols <- c(id_cols, grep('^Bl_', names(water_sample_rawdata), value = TRUE))
water_sample_bl <- water_sample_rawdata[, ..bl_cols]

# Here, we may have multiple rows per sample so fill in the id columns down for those samples, then convert - and + to 0 and 1.
water_sample_bl[, (id_cols) := lapply(.SD, na.locf), .SDcols = id_cols]
pres_abs_cols <- bl_cols[!bl_cols %in% c(id_cols, 'Bl_species')]
water_sample_bl[, (pres_abs_cols) := lapply(.SD, function(x) as.numeric(x == '+')), .SDcols = pres_abs_cols]

# Separate AR bacteria (E.coli, Salmonella, and MDR Enterococcus) into a separate dataframe
ar_pres_abs_cols <- c(grep('^AR_Ecoli', names(water_sample_rawdata), value = TRUE), grep('^Salmonella', names(water_sample_rawdata), value = TRUE), grep('^Enterococcus', names(water_sample_rawdata), value = TRUE), 'ESBL', 'CRE')
ar_cols <- c(id_cols, ar_pres_abs_cols)
water_sample_ar <- water_sample_rawdata[, ..ar_cols]

# Again, fill in the ID columns down for any samples with multiple rows, then convert - and + to 0 and 1.
water_sample_ar[, (id_cols) := lapply(.SD, na.locf), .SDcols = id_cols]
water_sample_ar[, (ar_pres_abs_cols) := lapply(.SD, function(x) as.numeric(x == '+')), .SDcols = ar_pres_abs_cols]
```

Do similar processing for the wastewater samples tab. Again borrow the corrected names code from the UGA statistician and modify.

```{r, eval = FALSE}
correct_names_wastewater = c("sample_no", 'season', 'site', 'Ecoli_counts',
                             'Bl_species',
                             'Bl_Amp','Bl_Faz','Bl_Fep','Bl_Fot','Bl_Fox','Bl_Pod','Bl_Taz','Bl_Axo','Bl_Cep','Bl_Cip','Bl_Gen','Bl_Imi','Bl_P_T4','Bl_Mer',
                             'Bl_blaCTX_M','Bl_blaTEM','Bl_blaCMY_2','Bl_blaSHV','Bl_blaOXA','Bl_blaIMI_NmcA','Bl_blaKPC',
                             'ESBL','CRE',
                             'AR_Ecoli_presence',
                             'AR_Ecoli_Amo_Cla','AR_Ecoli_Amp','AR_Ecoli_Azi','AR_Ecoli_Fox','AR_Ecoli_Tio','AR_Ecoli_Axo','AR_Ecoli_Cip','AR_Ecoli_Gen','AR_Ecoli_Nal','AR_Ecoli_Str','AR_Ecoli_Sul','AR_Ecoli_Tet','AR_Ecoli_Tri_Smx',
                             'Salmonella_presence',
                             'Salmonella_Str','Salmonella_Tet',
                             'Enterococcus_presence',
                             'Enterococcus_Cip','Enterococcus_Dap','Enterococcus_Ery','Enterococcus_Lin','Enterococcus_Nit','Enterococcus_Pen','Enterococcus_Str','Enterococcus_Syn','Enterococcus_Tet','Enterococcus_Tyl',
                             'Amo','Amp','Azi','Axo','Taz','Tio','Cip','Dap','Ery','Gen','Kan','Lin','Lnz','Mer','Met','Nal',
                             'Oxa','Pen','Smx','Sul','Str','Tig','Tri','Tet','Tyl','Van','total',
                             'abs_ermB','abs_tetB','abs_blaKPC','abs_blaSHV','abs_qnrS','abs_blaCTX-M','abs_total',
                             'rlt_ermB','rlt_tetB','rlt_blaKPC','rlt_blaSHV','rlt_qnrS','rlt_blaCTX-M','rlt_total'
)

# Correct names and create indicator column for influent versus effluent
setnames(wastewater_sample_rawdata, correct_names_wastewater)
wastewater_sample_rawdata <- separate(wastewater_sample_rawdata, site, into = c('site', 'type'), sep = ' ')
wastewater_sample_rawdata[, season := tolower(season)]

ww_id_cols <- c('sample_no', 'season', 'site', 'type')

# Create data frame with just ecoli counts that can be used as a key to join all the other ones together
ecoli_cols <- c(ww_id_cols, 'Ecoli_counts')
wastewater_sample_ecolicounts <- wastewater_sample_rawdata[, ..ecoli_cols]
wastewater_sample_ecolicounts <- wastewater_sample_ecolicounts[!is.na(sample_no) & !duplicated(sample_no)]

# Separate the column with AR salmonella presence and number of isolates combined into one column into two separate columns
wastewater_sample_rawdata[, Salmonella_n_isolates := as.numeric(str_extract(Salmonella_presence, '[0-9]'))]
wastewater_sample_rawdata[, Salmonella_presence := substr(Salmonella_presence, 1, 1)]

# Separate antibiotic concentrations into a separate dataframe
antibiotic_conc_idx <- which(names(wastewater_sample_rawdata) == 'Amo'):which(names(wastewater_sample_rawdata) == 'total')
antibiotic_conc_cols <- c(ww_id_cols, names(wastewater_sample_rawdata)[antibiotic_conc_idx])

# Here also get rid of the duplicated rows
wastewater_sample_antibiotic_conc <- wastewater_sample_rawdata[, ..antibiotic_conc_cols]
wastewater_sample_antibiotic_conc <- wastewater_sample_antibiotic_conc[!is.na(sample_no) & !duplicated(sample_no)]

# Separate ARG copy numbers into a separate dataframe
arg_copy_cols <- c(ww_id_cols, grep('(^abs)|(^rlt)', names(wastewater_sample_rawdata), value = TRUE))

# Again, get rid of the duplicated rows
wastewater_sample_arg_copynum <- wastewater_sample_rawdata[, ..arg_copy_cols]
wastewater_sample_arg_copynum <- wastewater_sample_arg_copynum[!is.na(sample_no) & !duplicated(sample_no)]

# Separate beta-lactamase into a separate dataframe
bl_cols <- c(ww_id_cols, grep('^Bl_', names(water_sample_rawdata), value = TRUE))
wastewater_sample_bl <- wastewater_sample_rawdata[, ..bl_cols]

# Here, we may have multiple rows per sample so fill in the id columns down for those samples, then convert - and + to 0 and 1.
wastewater_sample_bl[, (ww_id_cols) := lapply(.SD, na.locf), .SDcols = ww_id_cols]
pres_abs_cols <- bl_cols[!bl_cols %in% c(ww_id_cols, 'Bl_species')]
wastewater_sample_bl[, (pres_abs_cols) := lapply(.SD, function(x) as.numeric(x == '+')), .SDcols = pres_abs_cols]

# Separate AR bacteria (E.coli, Salmonella, and MDR Enterococcus) into a separate dataframe
ar_pres_abs_cols <- c(grep('^AR_Ecoli', names(wastewater_sample_rawdata), value = TRUE), grep('^Salmonella', names(wastewater_sample_rawdata), value = TRUE), grep('^Enterococcus', names(wastewater_sample_rawdata), value = TRUE), 'ESBL', 'CRE')
ar_cols <- c(ww_id_cols, ar_pres_abs_cols)
wastewater_sample_ar <- wastewater_sample_rawdata[, ..ar_cols]

# Again, fill in the ID columns down for any samples with multiple rows, then convert - and + to 0 and 1.
wastewater_sample_ar[, (ww_id_cols) := lapply(.SD, na.locf), .SDcols = ww_id_cols]
wastewater_sample_ar[, (ar_pres_abs_cols) := lapply(.SD, function(x) as.numeric(x == '+')), .SDcols = ar_pres_abs_cols]

```


Save all the processed data frames to CSV files.

```{r, eval = FALSE}
save_objs <- c("wastewater_sample_antibiotic_conc", 
"wastewater_sample_ar", "wastewater_sample_arg_copynum", "wastewater_sample_bl", 
"wastewater_sample_ecolicounts", 
"water_sample_antibiotic_conc", "water_sample_ar", "water_sample_arg_copynum", 
"water_sample_bl", "water_sample_environmental")

lapply(save_objs, function(x) fwrite(get(x), file.path('project/csv', paste0(x, '.csv'))))
```

## Exploratory data visualization

Here are some initial plots to take a look at what is going on with the data.

First reload the data that was processed previously to a clean and usable form. Also load the spatial data.

```{r}
w_antibiotic_conc <- fread('project/csv/water_sample_antibiotic_conc.csv')
w_ar <- fread('project/csv/water_sample_ar.csv')
w_arg_copynum <- fread('project/csv/water_sample_arg_copynum.csv')
w_bl <- fread('project/csv/water_sample_bl.csv')
w_env <- fread('project/csv/water_sample_environmental.csv')
ww_antibiotic_conc <- fread('project/csv/wastewater_sample_antibiotic_conc.csv')
ww_ar <- fread('project/csv/wastewater_sample_ar.csv')
ww_arg_copynum <- fread('project/csv/wastewater_sample_arg_copynum.csv')
ww_bl <- fread('project/csv/wastewater_sample_bl.csv')
ww_env <- fread('project/csv/wastewater_sample_ecolicounts.csv')

w_id_cols <- c('sample_no', 'season', 'site', 'area')
ww_id_cols <- c('sample_no', 'season', 'site', 'type')

sites <- st_read('project/sites.gpkg')
watersheds <- st_read('project/study_region_huc12s.gpkg')
```

### Maps of environmental variables

The environmental variables may vary over time and space. Let's make some maps of these variables (potential predictor variables) to see how they might vary.

```{r}
sites_env <- full_join(sites, w_env)

watersheds_proj <- st_transform(watersheds, crs = 26966)
```

Temperature appears to be higher in the SE part of the study area in summer. There is a very high temperature value in the winter -- might this be an error?

```{r, echo = FALSE}
theme_map <- theme(axis.text.x = element_blank(), axis.text.y = element_blank(),
                   axis.ticks.x = element_blank(), axis.ticks.y = element_blank())

ggplot() +
  geom_sf(data = watersheds_proj, alpha = 0.3) +
  geom_sf(data = sites_env, aes(fill = temperature), shape = 21, size = 2) +
  facet_wrap(~ season) +
  scale_fill_distiller(palette = 'RdYlBu') +
  theme_map + theme(legend.position = 'bottom')
```

pH does not seem to have a strong spatial pattern but it does seem to be highest (most basic) in spring and lowest (most acidic) in winter.

```{r, echo = FALSE}
ggplot() +
  geom_sf(data = watersheds_proj, alpha = 0.3) +
  geom_sf(data = sites_env, aes(fill = pH), shape = 21, size = 2) +
  facet_wrap(~ season) +
  scale_fill_distiller(palette = 'Reds', direction = 1) +
  theme_map + theme(legend.position = 'bottom')
```

Conductivity does not seem to vary much across the sites or seasons, so it is unlikely to explain much variation in any of the response variables. However there are some locations with very high conductivity values in winter.

```{r, echo = FALSE}
ggplot() +
  geom_sf(data = watersheds_proj, alpha = 0.3) +
  geom_sf(data = sites_env, aes(fill = conductivity), shape = 21, size = 2) +
  facet_wrap(~ season) +
  scale_fill_distiller(palette = 'RdYlGn', direction = -1) +
  theme_map + theme(legend.position = 'bottom')
```

As you might expect, turbidity is low everywhere in fall and winter but increases at some locations in spring and summer (doesn't seem to have a lot of spatial pattern).

```{r, echo = FALSE}
ggplot() +
  geom_sf(data = watersheds_proj, alpha = 0.3) +
  geom_sf(data = sites_env, aes(fill = turbidity), shape = 21, size = 2) +
  facet_wrap(~ season) +
  scale_fill_distiller(palette = 'RdYlGn', direction = -1) +
  theme_map + theme(legend.position = 'bottom')
```

Let's plot the *E. coli* counts too. I have used a (log+1) transform on the color scale. They do not seem to have an immediately obvious spatial pattern but they do decrease in winter, it seems like. That seems pretty plausible.

```{r, echo = FALSE}
ggplot() +
  geom_sf(data = watersheds_proj, alpha = 0.3) +
  geom_sf(data = sites_env, aes(fill = Ecoli_counts), shape = 21, size = 2) +
  facet_wrap(~ season) +
  scale_fill_distiller(palette = 'Blues', direction = 1, trans = 'log1p', breaks = c(10, 100, 1000)) +
  theme_map + theme(legend.position = 'bottom')
```


### E. coli counts, environmental variables, and presence of AR taxa

Join AR presence absence data with environmental data. 

```{r}
w_env_ar <- w_env[w_ar, on = w_id_cols]
season_order <- c('fall', 'winter', 'spring', 'summer')
w_env_ar[, season := factor(season, levels = season_order)]
```

Show seasonal trends in presence-absence of different AR taxa, ignoring environmental variables for now. Here we see that the counts of presences are relatively small so there is not very much basis to detect a trend, except possibly for *Salmonella* where we see all but 1 of the 11 presences were from the fall.

```{r, echo = FALSE}
w_ar_pres_abs <- melt(w_env_ar, id.vars = w_id_cols, measure.vars = c('AR_Ecoli_presence', 'Salmonella_presence',                   'Enterococcus_presence'), variable.name = 'taxon')
w_ar_pres_abs_total <- w_ar_pres_abs[, .N, by = .(season, taxon, value)]
w_ar_pres_abs_total[, present := factor(value, labels = c('absent', 'present'))]

ggplot(w_ar_pres_abs_total[!is.na(value)], aes(x = season, y = N, fill = present)) +
  geom_col(position = 'stack') +
  facet_wrap(~ taxon) +
  scale_fill_brewer(palette = 'Oranges') +
  scale_y_continuous(expand = c(0, 0))
```

FIXME: PUT MORE PLOTS AND MAPS HERE

Now here is a statistical model where I try to account for a number of factors to see whether environmental factors (I am including *E. coli* counts in with the environmental factors) influence the joint presence and absence of different AR taxa. We will try to put all the AR taxa into one model as a multivariate response because the different environmental factors may affect their presence-absence probability similarly. Further, we will account for any seasonality in the data. Finally, we will account for the repeated measures structure of the data, where the data was sampled multiple times per site. We will not account for the spatial location of the different sites explicitly; instead, we will just give each site a random intercept.

```{r}
w_env_ar_model_data <- w_env_ar[, .(sample_no, season, site, temperature, pH, conductivity, turbidity, Ecoli_counts,
                                    AR_Ecoli_presence, Salmonella_presence, Enterococcus_presence, ESBL, CRE)]


```

